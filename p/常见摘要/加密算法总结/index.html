<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="读书时的碎碎念"><title>常见摘要/加密算法总结</title>
<link rel=canonical href=https://selfsolo.com/p/%E5%B8%B8%E8%A7%81%E6%91%98%E8%A6%81/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="常见摘要/加密算法总结">
<meta property="og:description" content="读书时的碎碎念">
<meta property="og:url" content="https://selfsolo.com/p/%E5%B8%B8%E8%A7%81%E6%91%98%E8%A6%81/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/">
<meta property="og:site_name" content="Sera Wang">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Security"><meta property="article:published_time" content="2018-08-18T21:14:23+08:00"><meta property="article:modified_time" content="2018-08-18T21:14:23+08:00">
<meta name=twitter:title content="常见摘要/加密算法总结">
<meta name=twitter:description content="读书时的碎碎念">
<link rel="shortcut icon" href=https://ser4wang.oss-cn-beijing.aliyuncs.com/IMG_3605.JPG>
</head>
<body class=article-page>
<script>(function(){const a='StackColorScheme';localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
on-phone--column compact">
<aside class="sidebar left-sidebar sticky">
<button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
<header class=site-info>
<figure class=site-avatar>
<img src=https://ser4wang.oss-cn-beijing.aliyuncs.com/20210731222602.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</figure>
<h1 class=site-name><a href=https://selfsolo.com>Sera Wang</a></h1>
<h2 class=site-description>Le vent se lève, il faut tenter de vivre.</h2>
</header>
<ol class=menu id=main-menu>
<li>
<a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span>
</a>
</li>
<li>
<a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span>
</a>
</li>
<li>
<a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span>
</a>
</li>
<li>
<a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span>
</a>
</li>
</ol>
</aside>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/security/ style=background-color:#2a9d8f;color:#fff>
Security
</a>
</header>
<h2 class=article-title>
<a href=/p/%E5%B8%B8%E8%A7%81%E6%91%98%E8%A6%81/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/>常见摘要/加密算法总结</a>
</h2>
<h3 class=article-subtitle>
读书时的碎碎念
</h3>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 18, 2018</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
2 min read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<p>最近逛到某网站碰到一个叫JWTtoken的验证机制，然后百度了一波jwt，再解码此jwttoken后看到是RSA256加密，明明最近才看过现在又忘光了…于是对常见算法做个总结吧！原理不会特别详细，只会介绍简单原理，让我以后再碰上不至于太懵逼。</p>
<h1 id=基本概念>基本概念</h1>
<blockquote>
<p>安全性原则：</p>
</blockquote>
<ol>
<li>保密性</li>
<li>完整性(内容不被篡改)</li>
<li>身份认证</li>
<li>不可抵赖性</li>
</ol>
<blockquote>
<p>对称/非对称加密</p>
</blockquote>
<p>若加解密使用相同密钥，则称为对称密钥加密，否则称为非对称密钥加密。</p>
<blockquote>
<p>对称密钥加密:Diffie-Hellman算法</p>
</blockquote>
<p>因为密钥发布和密钥交换存在很多问题，所以要知道Diffie-Hellman密钥交换协议/算法。</p>
<p>通信双发可用此方法确定对称密钥，此方法只能用于密钥交换，而非加解密消息。</p>
<pre><code>算法描述: 

设A与B要确定密钥
1) A与B确定2个大素数 n 和 g 。 不必保密

2) A选择另一个大随机数X，计算:
   k1 = g^X mod n 后将k1发给B

3) B选择另一个大随机数Y，计算:
   k2 = g^Y mod n 后将k2发给A

4) 则密钥即为: 
   kA = k2^X mod n
   kB = k1^Y mod n

   且kA = kB
</code></pre><p>原理:</p>
<p>kA = (g^Y mod n)^X mod n = g^YX mod n</p>
<p>kB = (g^X mod n)^Y mod n = g^XY mod n</p>
<p>当然，这个容易受中间人攻击，攻击者可以同时与两方通信交换密钥，因为此方法没有身份认证。（于是考虑CA）</p>
<blockquote>
<p>非对称密钥加密</p>
</blockquote>
<p>此模式中，A和B不用同时访问可信任第三方以求出锁与密钥对</p>
<p>B有密钥对私钥与公钥，公钥用于封箱，私钥用于开锁。B将公钥和锁(某个加密算法)发给任何人(如A)，使其可以安全地向B发送消息(公钥加密只有私钥能解密，保密性)。而B可以用私钥开锁得到内容。</p>
<p>一方从另一方接收安全消息时，就将锁与密钥对发给另一方。</p>
<blockquote>
<p>算法模式</p>
</blockquote>
<p>ECB,CBC,CFB,OFB,CTR</p>
<h1 id=des>DES</h1>
<p>数据加密标准 (Data Encryption Standard)</p>
<blockquote>
<p>工作原理:</p>
</blockquote>
<p>DES是个块加密法，按64位块长加密数据，即把64位明文作为DES的输入，输入64位密文。</p>
<p>加密与解密使用相同的算法和密钥，密钥长度为56位。</p>
<blockquote>
<p>加密步骤:</p>
</blockquote>
<ol>
<li>
<p>将64位明文块输入初始置换函数(IP)对明文进行初始置换(按某个表进行 位变换，比如第1位和第xx位交换)</p>
</li>
<li>
<p>产生转换块的2半(左明文LPT和右明文RPT，各32位)</p>
</li>
<li>
<p>每个LPT和RPT经过16轮加密（每轮: 各有自己的密钥，56位密钥移位后用一个位变换表产生不同的48位子密钥，然后将32位RPT进行拓展置换(就是某些位冗余)到48位，再进行S盒替换(复杂)，输出32位，再进行p盒替换，类似ip的简单置换，然后将LPT与p盒置换结果进行异或得到新的RPT，旧的RPT变成新的LPT）</p>
</li>
<li>
<p>最后将LPT和RPT重接起来，对组成的块进行最终置换FP输出64位密文</p>
</li>
</ol>
<blockquote>
<p>DES变体:</p>
</blockquote>
<p>双重DES，就是使用两密钥，密钥1对原文加密，结果再用密钥2加密。
三重DES，同上。</p>
<h1 id=rsa>RSA</h1>
<p>RSA是一种非对称密钥算法，基于这样的数学事实:两个大素数相乘很容易，而对得到的积求因子则很难，算法本身很简单，实际难度在于RSA选择和生成的密钥与公钥。</p>
<pre><code>算法描述:

为了生成RSA公钥和私钥，B需要执行如下:

1) 选择2个大素数p和q (值越大，破解RSA越困难，执行加解密时间越长，因为指数运算很费时)

2) 计算 n = p*q 和 z = (p-1)*(q-1)

3) 选择小于n的一个数e，且使e和z没有公因数(即e和z互素)，e将被用于加密

4) 求一个数d，使ed-1可以被z整除，即 ed mod z = 1

   d将被用于解密

5) B的公钥kB+是一对数(n,e)
   B的私钥kB-是一对数(n,d)
</code></pre><blockquote>
<p>A加密和B解密的过程如下</p>
</blockquote>
<p>设A要发给一个由整数m表示的比特报文(万物皆比特啊)，</p>
<p>A有公钥(n,e) , 且m &lt; n</p>
<p>A计算，得加密值C，发给B</p>
<p>C = m^e mod n</p>
<p>B有私钥(n,d)</p>
<p>收到C后解密得到m</p>
<p>m = C^d mod n</p>
<blockquote>
<p>工作原理</p>
</blockquote>
<p>报文m加密</p>
<p>C = m^e mod n</p>
<p>解密</p>
<p>m = C^d mod n
= (m^e mod n)^d mod n</p>
<p>因为 (a mod n)^d mod n = a^d mod n
所以</p>
<p>m = m^(e*d) mod n</p>
<p>即，只要证明上式即可</p>
<p>而根据数论中的一个结论:</p>
<p>如果p和q是素数，且有n=pq和z=(p-1)(q-1)，则</p>
<p>x^y mod n = x^(y mod z)mod n</p>
<p>所以</p>
<p>m^(e<em>d) mod n = m^(e</em>d mod z) mod n = m^1 mod n = m</p>
<h1 id=mac>MAC</h1>
<p>在讲HMAC之前，先得介绍消息认证码MAC(Message Authentication Code)，它和MD5，SHA之类的摘要算法区别在于它需要通信双方知道共享对称密钥(秘密)，因此MAC涉及加密过程</p>
<blockquote>
<p>MAC工作原理</p>
</blockquote>
<ol>
<li>A与B共享一个对称密钥K，是别人不知道的。</li>
<li>A计算MAC时，要将密钥K作用于消息M。A将消息M和计算后的H1发给B</li>
<li>B收到M，也用K对M求出H2</li>
<li>B比较H1和H2，相同则验证了消息的完整性，表明其未被篡改</li>
</ol>
<h1 id=hmac>HMAC</h1>
<p>HMAC是指基于hash的消息认证码(Hash-based Message Authentication Code)，基本思想是服用MD5与SHA-1之类现有消息摘要算法，把消息摘要看成一个黑盒子，用共享秘密密钥加密消息摘要，从而输出MAC。</p>
<p>即 报文M → hash(M) → K(hash(M))</p>
<p>具体加密过程不表…</p>
<p>…</p>
<p>…</p>
<p>其实按内容来说这个应该叫密码学入门比较好…但以后再碰上别的算法就会把它们陆续加进来。</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/security/>Security</a>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/p/spring-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/>
<div class=article-details>
<h2 class=article-title>Spring 漏洞总结</h2>
</div>
</a>
</article>
<article>
<a href=/p/yii2-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/>
<div class=article-details>
<h2 class=article-title>Yii2 漏洞总结</h2>
</div>
</a>
</article>
<article>
<a href=/p/thinkphp-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/>
<div class=article-details>
<h2 class=article-title>ThinkPHP 漏洞总结</h2>
</div>
</a>
</article>
<article>
<a href=/p/%E5%85%A5%E9%97%A8%E9%80%86%E5%90%91/>
<div class=article-details>
<h2 class=article-title>入门逆向</h2>
</div>
</a>
</article>
<article>
<a href=/p/%E5%88%A9%E7%94%A8%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E4%B8%8B%E8%BD%BDvol.moe%E7%9A%84%E6%89%80%E6%9C%89%E6%BC%AB%E7%94%BB/>
<div class=article-details>
<h2 class=article-title>利用越权漏洞下载vol.moe的所有漫画</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2017 -
2021 Sera Wang
</section>
<section class=powerby>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>