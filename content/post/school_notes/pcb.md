---
title: "代码模拟PCB"
description: 读书时的碎碎念
date: 2018-04-04T21:14:23+08:00
tags:
    - Python
Categories:
    - school_notes
---



界面打算参考XAMPP的设计风格，具体核心如何实现先来看一下PCB如何运作的以及目标是要写个什么东西。

------

PCB， 即进程控制块(Processing Control Block) ，是操作系统核心中一种数据结构，主要表示进程状态。

这里是实验要求的内容:

### 要求



```
1. 确定PCB内容及其组织方式；
2. 要求模拟进程”新建”、”就绪”、”运行”、”阻塞”和”退出”5个状态；
3. 设计并实现5个进程管理函数: 进程创建(Create()),进程终止(Terminate()),进程调度(Schedule()),进程阻塞(Block()),进程唤醒(Wakeup());
4. 编写主函数，调用5个函数，实现进程管理。
```





### 关键点



```
1.如何组织进程
确定PCB内容：标识信息、状态和运行时间与存储地址等信息、现场信息、管理信息；
PCB组织方式：链表，分 运行（running），就绪（ready），阻塞（block），空闲（spare）4个列表
```


我的理解：

PCB保存内容:
标识信息(Process ID);

状态 (进程的运行状态);

运行时间就是此进程从开始进程到此时运行的时间;

存储地址我觉得可以随便指定一个(因为模拟，所以就模拟个地址);

现场信息的话，我对此问了下老师，老师让自己想要不要加个程序进去，我想了下，既然是模拟，那可以这样，我模拟五个程序，每个程序要跑的时间是不同的，可以这样实现，每条进程，如果我不中止它，那它的就永远不终止，比如开始时它的指令计数器为1，time.sleep(1)后，这个数字加一…管理信息，我就不是特别清楚，我都画个gui出来了总该清楚的吧

```
2.如何创建进程
申请PCB -> 申请资源 -> 填写PCB -> 挂就绪(ready)队列
```


直接说就是，要创建了，点create，把它信息顺便就设置好(给它pid,记一下开始时间time.time),申请资源不是很懂，因为python我还没有看过数据结构是怎么实现的



```
3.如何实现处理机调度
a. 按某种策略（如FCFS） 从就绪(ready)队列选择一个进程；
b. 摘取PCB，挂运行（running）队列；
c. 修改状态等PCB内容；设置时钟（运行时间）；恢复现场；
d. 模拟运行： 比如输入”Esc” 进入 “阻塞(Block)”状态，输入”Enter”则运行结束回到就绪（ready）队列；
e. 修改(剩余)运行(running)时间。
```


根据内容来看，调度(Schedule)这个函数，就是实现把进程从ready队列放到running队列，然后因为running队列内容变了，所以要相应改变PCB的内容，比如运行时间(相当于恢复现场)，
对于实现(d)来说，我不是很明白，模拟运行的意思是什么，我的理解是调用schedule(“esc”)，就会让此进程从running进入block，调用schedule(“enter”),就会让它进入ready队列。



### 综上

于是我们对于我们要写的东西就有一个总结，所有进程都是一个类，初始化时配置它的标识符(PID),

#### 状态


运行态: running, 进程正在执行。因为是单处理器，同一时刻在运行的进程只有一个。

就绪态: ready, 进程做好了准备，只要有机会就开始执行,这里要判断优先级，比如3个进程同时ready，的话，先根据优先级判断执行顺序，然后再按FCFS策略来执行进程

阻塞态: block, 进程在某些时间发生前不能执行，如I/O操作完成

空闲态: spare, 它表示进程还未被加入可执行进程组，它通常是PCB已经创建但还未加载到内存中的新进程

退出态: terminate, 要么它自身停止(这个程序中我们一般认为它会一直运行下去，程序计数器一直加一，每次加一后跟time.sleep(1)操作，直到加到一个相当长的数字，比如100，100后自动terminate程序)，或者用户主动中断运行此进程



#### 函数

create()：相当于类的**init**()函数，

terminate(): 相当于多线程中的self.runnning = false

schedule(): 这个函数实现各种中间调度过程，比如用户执行了某些命令，则对进程进行相应操作，

block(): 使进程进入阻塞队列(block)

wakeup(): 使进程从阻塞队列(block)中被唤醒，重新ready